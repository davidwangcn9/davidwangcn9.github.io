---
layout:     post
title:      澳洲支付 之 基础篇【一】
subtitle:   支付交付
date:       2022-08-01
author:     大风哥
header-img: img/buy-buy-buy-1.png
catalog: true
tags:
    - 支付
    - 澳洲
    - 卡支付
---

#### 开篇
我承认，这（喜）是（爱）标题党。为啥是澳洲，为啥是买买买！容我娓娓道来！
其实考虑再三，写一篇文章到底是科学严谨呢，还是诙谐幽默，我思考了很久（2分钟），终于决定用这种形式给大家科(唠)普(叨)一下，希望可以帮助大家答(越)疑(来)解(越)惑(糊)。以下是我想要讲的内容大纲：

澳洲支付的一些基本原理，应用场景与渠道，以及相关周边（在线支付，欺诈），以及大家都非（可）常（能）关心的作为开发集成中会踩的坑，以及开发团队如何更高效的集成支付。

虽说这个说的是澳洲，其实支付原理全球基本一致，所以对于想粗略了解一下支付基础，增加有用的知识，还是可以坚持一下，看看再说。

#### 支付
也是payment（这不是废话嘛。。）

支付是什么，从原始社会开始，支付就已经存在。从以物换物，到贝壳钱币，到了封建时代，各国货币的诞生，三晋布币燕国刀币，到秦始皇一统中国，统一货币形式，再到金银元宝，铜钱串灯，再到现代我们使用现金，电子支付，卡支付，虚拟货币支付等等，支付贯穿始终。让我不禁想起那句老话，只要有人的地方，就有江湖，只要有江湖的地方，就有支付。。。

说了半天，支付到底是啥，来一起看看维基百科的定义吧：

付款是一方（例如个人或公司）自愿向另一方提供金钱或其等价物或有价物品，以换取另一方提供的商品或服务，或履行法律义务。

今天不讲贝壳，不讲金元宝，我们今天就聊一聊现代的澳洲支付，为啥是澳洲呢，因为我上一个项目做的是澳洲的，原因是不是很自洽！

 

为了更近一步的了解支付，当然要从宏观到微观了，宏观上的定义已经给了，那么微观上来讲，支付到底是哪些关键组件构成，这些组件是如何协作完成支付的呢？

![pic](/img/buy-buy-buy-1.png "支付流程")

如图，这就是一个比较标准的支付组件以及全流程，重要的参与方有客户和商家。一个提供金钱，一个提供商品或者服务。支付由一套完整的系统协助完成，而这一套系统又由完全不同的组件由不同的组织运营，其中就包括了支付入口（通俗理解购买平台比如线下柜台或者现在淘宝），支付网关，支付处理机构，银行，共同完成支付。不要被这些看起来就很复杂的东西吓到，让我继续道来。。。

#### 支付类型

工欲善其事，必先利其器。假如我在澳洲要要去支付，那到底有哪些支付方式，那种最方便，最快捷，最便宜，最实惠（羊毛最多），以下就给大家展现一下：

![pic](/img/buy-buy-buy-2.png "支付分类")

当然这里列举的只是一些主流的支付方式，还有一些更加高级的支付形式，比如二维码，电子钱包，NFC，令牌卡支付，其实都是结合以上这些老牌支付渠道，用比较新颖的方式呈现出来而已，所以在这篇文章中就不赘述了。

###### 现金支付

首先看看现金支付，比如兴高采烈的Lucy拿了500块，高高兴兴的去小米线下店里买了一款最新蓝牙耳机，当她交钱拿到耳机后，支付也就结束了。

![pic](/img/buy-buy-buy-3.png "支付分类")

简单不简单，直接不直接。这个可是近现代最有名气的支付方式了，澳洲中国全世界，谁没接触过现金支付（也许中国的一零后还真不太会接触过。。。），不过呢，这种支付方式正在慢慢退出历史饿舞台。大家其实可以细想下，在国内到底有多久没有使用过现金了，至少我好像也就在过年发红包的时候会用到。不知不觉中现金也慢慢像红包一样成为了一种历史文化的沉淀。这种现象的发生，其实也是大势所趋，由于支付形式与形态发生变化导致了，其中最为有有代表性的当属卡支付了。

###### 卡支付

说到卡支付，又不得不提线上与线下的卡支付，先来聊聊（2.1）线上卡支付：

线上卡支付其实说白了就是允许买家使用信用卡/借记卡在网上就行支付的方式，是不是突然就有了小姐姐在双11淘宝血拼，信用卡刷爆的即视感。是的，没错，就是它提供了这种支付方式，提供了便利性，动动手指头，就可以买下自己心爱之物的magic。

以上只是表象，其实线上卡支付包含了两部分，授权（Authorization）与清算结算（clearing and settlement），想要搞清楚线上卡支付，或者想要深入理解做到举重若轻，我们还是以快乐的Lucy为例，Lucy用一张HSBC发行的信用卡在amazon上购(血)买(拼)，再她输入卡号后几秒内，amazon就会显示支付成功，接下来快乐的Lucy就等着发货了。有没有非常好奇，那几秒钟到底发生了什么，为什么商家就有信心给Lucy发货，可以参考以下流程。

###### 卡支付 - 授权（Authorization）

![pic](/img/buy-buy-buy-4.png "卡支付授权")

在以上流程里，又出现了一个新的成员 – 卡组织，这是个一个全球化的组织，里面的成员有Visa，Mastercard，AMEX等等，国内最大的银联。请注意卡组织在支付中起到了非常大的作用，每张由发卡行发布的信用卡或者借记卡都会加入一个或者多个卡组织，这样在收单机构处理支付请求时，只需要根据卡号将授权请求发送给相应的卡组织，卡组织则负责联系发卡行，发卡行决定是否授权成功或者失败。什么时候会失败了，聪明的你一定想到比如血拼过多导致超过额度的情况下，就会导致授权失败，当然了，这只是失败的其中一种情况。

再细细看一下整个流程（如上图），从step2到step7，根据支付行业标准，支付一般情况下需要在3秒内完成。从开发的角度考虑，其实具有相当的技术挑战毕竟中间有如此多的在不同组件中的通信。由此可见，支付整套框架前前后后被不少技术大拿反复拿捏了很久才有当前的行业标准。

到了step8，此时此刻商家有没有收到钱呢？准确答案是没有。那商家什么时候可以收到钱呢？让我们隆重介绍

###### 卡支付 - 清算结算（clearing and settlement）

![pic](/img/buy-buy-buy-5.png "卡支付清算结算")

一般情况下，清算结算发生在授权当天晚上，用黑话说就是在cutoff day之前发生的所有授权都会被放到清算和结算的流程中。这一步做完后，商家就收到钱了。当然了，这个工作一般都在底层由现有框架自动完成，作为程序员的我们是不需要操心的，不过钱到底是什么到账，与cutoff day时间和不同的支付处理机构（acquirer）制定的政策是息息相关的，所以如果被客户抱怨为啥没到账的你，务必可以先看看以上条件然后再从容的去做production support。

聊完线上卡支付，我们一起看看


###### 线下卡支付

![pic](/img/buy-buy-buy-6.png "线下卡支付")

快乐的Lucy showup again，她拿着没有超过额度的信用卡，去MYER商场里疯狂shopping了一番，这个时候POS机就发挥了重要的作用作为支付的入口。国内来说随着电子支付越来越普遍，POS机也慢慢越来越少，然而在澳洲，POS机还是很常见的，并且叫EFTPOS，这也是和国内目前比较显著的区别。

聊完卡支付，我们再一起看一下另一个非常重要的支付形式

###### 银行转账

澳洲的银行转账分为两大类BECS（Bulk Electronic Clearing System）和NPP（New Payment Platform）。总而言之，BECS更久一些，便宜，支付到账周期时间长；NPP新一些，支付到账周期时间短。你懂的，新的事物要替换老的需要时间，尤其在金融支付领域，这种以稳为主的行业，就更慢了。

###### 银行转账 - BECS

![pic](/img/buy-buy-buy-7.png "BECS")

头先不要大，看起来复杂，其实确实也挺复杂。再加上银行转账里有些黑话，比如说Direct Debit(DD) 也就是收钱进来, Direct Credit(DC) 也就是打钱出去, 听起来就更费劲了。不过不要担心，容我娓娓道来：

故事还得从头大的Lucy通过ANZ银行转账给她的朋友Lily讲起，ANZ在收到请求后，会记录下来，并在当天整理出一个DE file，发送给收款银行westpac，westpac在收到请求后也会记录下来，并将钱转给Lily。之后就是银行之间以及与Reserve bank of Australia的一些交互了，直到settle清为止。BECS还是比较慢的，从发起请求，到收到钱一般需要3天左右的时间。是不是经过梳理清（糊）晰（涂）多了！

###### 银行转账 - NPP

![pic](/img/buy-buy-buy-7.png "NPP")

NPP的流程和BECS比较类似，不过最大的不同是有了FSS这么一个机构的介入。由于FSS，整个流程变得更迅速。官方文档说是实时支付到账，不过根据我们的经验，NPP到账大概需要5～15分钟，还没有完全到达实时的能力，同时呢, 目前还只支持DC，DD还在开发中（果然很新的样子）

 

洋洋洒洒也说了好多，发现才介绍了不到四分之一的内容。后面会继续和大家分（唠）享（叨）快乐的澳洲买买买的弯弯绕绕：）




